<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Protein Concentration Calculator</title>
</head>
<body>
    <h1>Protein Concentration Calculator</h1>
    <form id="calculator">
        <label for="concentration">Enter Bradford Absorbance:</label>
        <input type="number" id="concentration" name="concentration" step="any" required>
        <label for="molecularWeight">Enter Molecular Weight (kDa):</label>
        <input type="number" id="molecularWeight" name="molecularWeight" step="any">
        <label for="aminoAcidSequence">Enter Amino Acid Sequence:</label>
        <input type="text" id="aminoAcidSequence" name="aminoAcidSequence">
        <button type="button" onclick="calculateAbsorbance()">Calculate</button>
    </form>
    <p id="result"></p>

    <script>
        const aminoAcidWeights = {
            A: 89.047678, C: 121.019749, D: 133.037508, E: 147.053158, F: 165.078979,
            G: 75.032028, H: 155.069477, I: 131.094629, K: 146.105528, L: 131.094629,
            M: 149.051049, N: 132.053492, O: 255.158292, P: 115.063329, Q: 146.069142,
            R: 174.111676, S: 105.042593, T: 119.058243, U: 168.964203, V: 117.078979,
            W: 204.089878, Y: 181.073893
        };

        const waterWeight = 18.01528;

        function calculateMolecularWeight(sequence) {
            let weight = 0;
            for (let i = 0; i < sequence.length; i++) {
                const aminoAcid = sequence[i].toUpperCase();
                if (aminoAcidWeights[aminoAcid]) {
                    weight += aminoAcidWeights[aminoAcid];
                } else {
                    return NaN;
                }
            }
            // Subtract the weight of water for each peptide bond
            weight -= (sequence.length - 2) * waterWeight;
            return weight / 1000; // Convert to kDa
        }

        function calculateAbsorbance() {
            const concentration = parseFloat(document.getElementById('concentration').value);
            let molecularWeight = parseFloat(document.getElementById('molecularWeight').value);
            const aminoAcidSequence = document.getElementById('aminoAcidSequence').value;

            if (isNaN(molecularWeight) && aminoAcidSequence) {
                molecularWeight = calculateMolecularWeight(aminoAcidSequence);
            }

            if (isNaN(concentration) || isNaN(molecularWeight)) {
                document.getElementById('result').innerText = "Please enter valid numbers.";
                return;
            }

            // Coefficients for the quadratic equation ax^2 + bx + c = 0
            const a = -1.0787;
            const b = 2.214;
            const c = -concentration;

            // Calculate the discriminant
            const discriminant = Math.pow(b, 2) - 4 * a * c;

            if (discriminant < 0) {
                document.getElementById('result').innerText = "No real solutions.";
                return;
            }

            // Calculate the first solution
            const x1 = (-b + Math.sqrt(discriminant)) / (2 * a);

            // Convert mg/ml to micromolar
            const micromolar = (x1 * 1000) / molecularWeight;

            // Display the result
            document.getElementById('result').innerText = `Absorbance Value: x = ${x1.toFixed(2)} mg/ml, which is ${micromolar.toFixed(2)} ÂµM. Molecular Weight: ${molecularWeight.toFixed(2)} kDa`;
        }
    </script>
</body>
</html>
